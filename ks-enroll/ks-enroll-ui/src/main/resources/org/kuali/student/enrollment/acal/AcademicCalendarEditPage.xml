<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util-2.0.xsd">

    <bean id="KS-AcademicCalendar-EditPage" parent="Uif-Page" p:disclosure.render="false">
        <property name="id" value="academicCalendarEditPage"/>
        <property name="headerText" value="@{!newCalendar ? academicCalendarInfo.name : 'New Academic Calendar'}"/>
        <property name="header">
            <bean parent="Uif-HeaderTwo"/>
        </property>
        <property name="header.rightGroup">
            <bean parent="Uif-HorizontalBoxGroup">
                <property name="items">
                    <list>
                        <bean parent="Uif-ActionLink" p:methodToCall="toCopy" p:actionLabel="Copy" p:style="text-align:center;" p:render="@{#view.readOnly}"/>
                        <bean parent="Uif-ActionLink" p:methodToCall="toEdit" p:actionLabel="Edit" p:style="text-align:center;" p:render="@{#view.readOnly}"/>
                        <bean parent="Uif-ActionLink" p:actionScript="confirmDeletion('Are you sure you want to delete this academic calendar?')" p:methodToCall="delete" p:actionLabel="Delete" p:style="text-align:center;" p:render="@{#view.readOnly and !officialUI}"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-TabGroup" >
                    <property name="items">
                        <list>
                            <ref bean="KS-AcademicCalendar-EditSection"/>
                            <ref bean="KS-AcademicTerm-EditSection"/>
                        </list>
                    </property>
                    <property name="tabsWidget.templateOptionsJSString">
                        <value>
                          { selected: @{defaultSelectedTabIndex} }
                        </value>
                      </property>
                </bean>
            </list>
        </property>
        <property name="footer">
            <bean parent="Uif-FooterBase">
                <property name="items">
                    <list>
                        <bean parent="Uif-PrimaryActionButton" p:render="@{!#view.readOnly}"
                              p:methodToCall="@{officialCalendar ? 'save' : 'makeAcalOfficial'}"
                              p:actionLabel="@{officialCalendar ? 'Update Official' : 'Make Official'}"
                              p:disabled="@{newCalendar}" p:performClientSideValidation="true" />
                        <bean parent="Uif-SecondaryActionButton" p:methodToCall="save" p:actionLabel="Save"
                              p:performClientSideValidation="true" p:render="@{!officialCalendar and !#view.readOnly}"/>
                        <bean parent="Uif-ActionLink" p:methodToCall="delete"
                              p:actionLabel="Delete Draft"
                              p:actionScript="confirmDeletion('Are you sure you want to delete this academic calendar?')"
                              p:render="@{!newCalendar and !#view.readOnly and !officialUI}"/>
                        <bean parent="Uif-ActionLink" p:actionLabel="Cancel" p:actionScript="stepBrowserBack()" p:render="@{!#view.readOnly}"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="KS-AcademicCalendar-EditSection" parent="Uif-VerticalBoxSection" p:disclosure.render="false" p:id="acal-info" p:style="min-width:70em;" >
        <property name="headerText" value="Information" />
        <property name="items">
            <list>
                <bean parent="Uif-Message" p:messageText="@{updateTimeString}" p:cssClasses="font-light12"/>
                <ref bean="KS-AcademicCalendar-MetaSubSection"/>
                <ref bean="KS-AcademicCalendar-EventSubSection"/>
                <ref bean="KS-AcademicCalendar-HolidaySubSection"/>
            </list>
        </property>
    </bean>

    <bean id="KS-AcademicCalendar-MetaSubSection" parent="Uif-HorizontalBoxSubSection">
        <property name="id" value="KS-AcademicCalendar-MetaSubSection" />
        <property name="headerText" value="Calendar Information" />
        <property name="disclosure.render" value="false"/>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:propertyName="academicCalendarInfo.name"
                      p:label="Academic Calendar Name" p:labelPlacement="TOP" p:required="true">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="30" />
                    </property>
                </bean>
                <bean parent="Uif-InputField-LabelTop" p:propertyName="academicCalendarInfo.adminOrgId"
                      p:label="Organization" p:labelPlacement="TOP">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="org-options"/>
                    </property>
                    <!-- <property name="optionsFinder">
                      <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.OrgKeyValues"/>
                    </property>   -->
                </bean>
                <bean parent="Uif-InputField" p:propertyName="academicCalendarInfo.startDate"
                      p:label="Start Date" p:labelPlacement="TOP" p:required="true">
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="10" p:watermarkText="mm/dd/yyyy" />
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="academicCalendarInfo.endDate"
                      p:label="End Date" p:labelPlacement="TOP" p:required="true">
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="10" p:watermarkText="mm/dd/yyyy"/>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <!-- NOTE:
                        This hidden button defeats a KRAD 2.0 bug which causes Enter to fire the next action
                        found - in this case, the "add" button of the addline for the Holidays collection.
                -->
                <bean parent="Uif-SecondaryActionButton-Small" p:style="visibility:hidden;width:2px;" p:actionScript="void(0);"/>
                <!-- END OF KRAD WORK-AROUND -->
            </list>
        </property>
    </bean>

	<bean id="KS-AcademicCalendar-EventSubSection" parent="Uif-Disclosure-TableCollectionSubSection"
		  p:layoutManager.numberOfColumns="@{#view.readOnly ? 3 : 7}" p:id="acal-info-event">
		<property name="headerText" value="Events" />
        <property name="disclosure.defaultOpen" value="@{!#form.events.empty}"/>
        <property name="instructionalText" value="@{!#view.readOnly ? 'Adding events is optional.' : ''}"/>
        <property name="instructionalMessage.render" value="@{!#view.readOnly}"/>
        <property name="instructionalMessage">
          <bean parent="Uif-InstructionalMessage"/>
        </property>
		<property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.AcalEventWrapper" />
		<property name="propertyName" value="events" />
		<property name="layoutManager.sequencePropertyName" value="name" />
		<property name="layoutManager.renderSequenceField" value="false" />
		<property name="layoutManager.generateAutoSequence" value="false" />
        <property name="layoutManager.separateAddLine" value="false" />
        <property name="layoutManager.richTable.disableTableSort" value="true" />
        <property name="addLineLabel.labelText" value=""/>
        <property name="layoutManager.richTable.render" value="false" />
        <property name="layoutManager.applyAlternatingRowStyles" value="false" />
		<property name="items">
			<list>
				<bean parent="Uif-InputField" p:propertyName="eventTypeKey" p:label="Event" p:required="true"
                      p:readOnly="@{!#isAddLine}" p:style="font-weight:bold;" p:readOnlyDisplayReplacementPropertyName="eventTypeName">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.AcalEventTypeKeyValues" p:addBlankOption="false"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="startDate" p:label="Start Date" p:required="true"
                      p:style="font-weight:normal;" p:readOnlyDisplayReplacementPropertyName="startDateUI">
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                    </property>
                     <property name="validCharactersConstraint">
                         <bean parent="BasicDatePatternConstraint" />
                     </property>
                 </bean>
                <bean parent="Uif-InputField" p:propertyName="startTime" p:render="@{!#view.readOnly}"
                      p:label="Start Time" p:id="timeFieldStart">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="startTimeAmPm" p:render="@{!#view.readOnly}"
                      p:required="@{!#empty(#lp.startTime)}" p:id="timeFieldStartAmPm">
                     <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay}"/>
                        </bean>
                    </property>
                 </bean>
                <!-- NOTE: for progressiveRender condition below, "dateRange eq true" DOESN'T WORK -->
                <bean parent="Uif-InputField" p:propertyName="endDate" p:render="@{!#view.readOnly}"
                      p:label="End Date" p:required="@{#lp.dateRange and !#isAddLine}"
                      p:refreshWhenChangedPropertyNames="#lp.dateRange" p:id="endDate">
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy">
                            <property name="disabled" value="@{!#lp.dateRange}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-DataField" p:propertyName="endDateUI" p:render="@{#view.readOnly}"
                      p:label="End Date"/>
                <bean parent="Uif-InputField" p:propertyName="endTime" p:render="@{!#view.readOnly}"
                      p:label="End Time" p:id="timeFieldEnd">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                            <!--<property name="onKeyUpScript" value="setAttributesFromTimeField(jq(this));"/>-->
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="endTimeAmPm" p:render="@{!#view.readOnly}"
                      p:required="@{!#empty(#lp.endTime)}"
                      p:id="timeFieldEndAmPm">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay}"/>
                        </bean>
                    </property>
                 </bean>
                 <bean parent="Uif-InputField" p:propertyName="allDay" p:label="All Day" p:render="@{!#view.readOnly}" p:id="allDayCheckbox">
                     <property name="onClickScript" value="setAttributesFromAllDayCheckbox(jq(this));"/>
                    <property name="control">
                        <bean parent="Uif-CheckboxControl"/>
                    </property>
                 </bean>
                 <bean parent="Uif-InputField" p:propertyName="dateRange" p:label="Date Range" p:id="dateRangeCheckbox" p:render="@{!#view.readOnly}">
                    <property name="control">
                        <bean parent="Uif-CheckboxControl" />
                    </property>
                 </bean>
			</list>
		</property>
	</bean>

    <!--<bean id="KS-AcademicCalendar-HolidaySubSection" parent="Uif-VerticalBoxGroup">
        <property name="style" value="margin-bottom:0;"/>
        <property name="items">
            <list>
                &lt;!&ndash;<ref bean="KS-AcademicCalendar-HolidaySubSection-NotFound" />&ndash;&gt;
                <ref bean="KS-AcademicCalendar-HolidaySubSection" />
            </list>
        </property>
    </bean>-->
    <!--<bean id="KS-AcademicCalendar-HolidaySubSection-NotFound" parent="Uif-VerticalBoxSubSection">
        <property name="headerText" value="Holidays" />
        <property name="render" value="@{#form.holidayCalendarList.empty}"/>
        <property name="style" value="margin-bottom:0;"/>
        <property name="items">
            <list>
                <bean parent="Uif-Message" p:messageText="No Holiday Calendar available"/>
            </list>
        </property>
    </bean>-->
    <bean id="KS-AcademicCalendar-HolidaySubSection" parent="KS-Disclosure-HorizontalCollectionSubSection">
        <property name="id" value="acal-holidays" />
        <property name="headerText" value="Holidays" />
        <property name="propertyName" value="holidayCalendarList" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.HolidayCalendarWrapper" />
        <property name="collectionLookup.quickfinderAction.render" value="false" />
        <property name="layoutManager.lineGroupPrototype.disclosure.render" value="true"/>
        <property name="layoutManager.lineGroupPrototype.header.headerText" value="@{#line.holidayCalendarInfo.name}"/>
        <property name="layoutManager.lineGroupPrototype.footer.render" value="@{#isAddLine}"/>
        <property name="layoutManager.lineGroupPrototype.header.style" value="margin-bottom:5px;padding-bottom:0;"/>
        <property name="addLineLabel.labelText" value=""/>
        <property name="layoutManager.lineGroupPrototype.header.cssClasses">
          <list merge="true">
            <value>ks-borderBottom2</value>
          </list>
        </property>
        <property name="layoutManager.lineGroupPrototype.header.lowerGroup">
             <bean parent="Uif-HorizontalBoxGroup">
                 <property name="items">
                    <list>
                        <!-- DONT DELETE - For now, we're not displaying the hcal edit button as there are some issues with KRAD -->
                       <!--<bean parent="KS-SubmitActionLink" p:methodToCall="editHolidayCalendar" p:actionLabel="Edit" p:onClickScript="writeHiddenToForm(&quot;actionParameters[selectedLineIndex]&quot;, &quot;@{#index}&quot;);" p:render="@{!#view.readOnly}"/>  -->
                       <bean parent="Uif-ActionLink" p:methodToCall="deleteLine" p:actionLabel="Delete"
                             p:onClickScript="writeHiddenToForm(&quot;actionParameters[selectedLineIndex]&quot;, &quot;@{#index}&quot;);"
                             p:actionScript="performCollectionAction('acal-holidays');" p:render="@{!#view.readOnly}"/>
                    </list>
                 </property>
             </bean>
        </property>
        <property name="layoutManager.addLineGroup.header.lowerGroup">
             <bean parent="Uif-HorizontalBoxGroup">
                 <property name="items">
                    <list>
                       <bean parent="Uif-ActionLink" p:methodToCall="cancelAddingHoliday" p:actionLabel="Cancel Adding Holiday Calendar"
                             p:actionScript="performCollectionAction('acal-holidays');" p:render="@{!#view.readOnly}"/>
                    </list>
                 </property>
             </bean>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:label=" " p:propertyName="id" p:render="@{#isAddLine}"
                      p:refreshWhenChangedPropertyNames="academicCalendarInfo.startDate">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.HolidayWrapperListFinder" p:addBlankOption="false"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField"
                      p:propertyName="holidayCalendarInfo.name"
                      p:label="Holiday Calendar Name"
                      p:fieldLabel.width="40%"
                      p:width="60%"
                      p:readOnly="true"
                      p:render="@{!#isAddLine}"   >
                    <property name="control">
                        <bean parent="Uif-TextControl"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField"
                      p:propertyName="adminOrgName"
                      p:label="Organization"
                      p:readOnly="true"
                      p:render="@{!#isAddLine}"   >
                    <property name="control">
                        <bean parent="Uif-TextControl"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField"
                      p:propertyName="holidayCalendarInfo.startDate"
                      p:label="Start Date"
                      p:readOnly="true"
                      p:render="@{!#isAddLine}" >
                    <property name="control">
                        <bean parent="Uif-TextControl"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField"
                      p:propertyName="holidayCalendarInfo.endDate"
                      p:label="End Date"
                      p:readOnly="true"
                      p:render="@{!#isAddLine}" >
                    <property name="control">
                        <bean parent="Uif-TextControl"/>
                    </property>
                </bean>
            </list>
        </property>
        <property name="subCollections">
           <list>
             <ref bean="KS-Holidays-SubSection" />
           </list>
        </property>
    </bean>

    <bean id="KS-Holidays-SubSection" parent="Uif-TableSubCollection-WithinSection" p:readOnly="true"
          p:id="acal-hc-holidays" p:layoutManager.numberOfColumns="4"
          p:layoutManager.style="width: 70%;">
     <property name="headerText" value="Holidays" />
     <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.HolidayWrapper" />
     <property name="layoutManager.applyDefaultCellWidths" value="false" />
     <property name="layoutManager.applyAlternatingRowStyles" value="false" />
     <property name="propertyName" value="holidays" />
     <property name="layoutManager.renderSequenceField" value="false" />
     <property name="layoutManager.generateAutoSequence" value="false" />
     <property name="layoutManager.separateAddLine" value="false" />
     <property name="layoutManager.richTable.render" value="false" />
     <property name="header.style" value="margin-top:1em;"/>
     <!--<property name="header.cssClasses">
      <list merge="true">
        <value>ks-borderBottom1</value>
      </list>
     </property>-->
     <!--<property name="layoutManager.cssClasses">
        <list merge="true">
            <value>ks-tablecollection-header-center</value>
        </list>
     </property>-->
     <property name="items">
       <list>
         <bean parent="Uif-InputField" p:propertyName="holidayInfo.name">
             <property name="control">
                <bean parent="Uif-TextControl"/>
             </property>
         </bean>
         <bean parent="Uif-InputField" p:propertyName="startDateUI" p:label="Start Date"
               p:style="font-weight:normal; text-align:center;" p:fieldLabel.style="text-align:center;">
             <property name="control">
                <bean parent="Uif-TextControl"/>
             </property>
         </bean>
         <bean parent="Uif-InputField" p:propertyName="endDateUI" p:label="End Date"
               p:style="font-weight:normal; text-align:center;" p:fieldLabel.style="text-align:center;">
             <property name="control">
                <bean parent="Uif-TextControl"/>
             </property>
         </bean>
         <bean parent="Uif-InputField" p:propertyName="holidayInfo.isInstructionalDay" p:label="Instructional"
               p:style="font-weight:normal; text-align:center;" p:fieldLabel.style="text-align:center;"
               p:readOnlyDisplayReplacement="@{#line.holidayInfo.isInstructionalDay ? 'Yes' : ' '}">
             <property name="control">
                <bean parent="Uif-CheckboxControl"/>
             </property>
         </bean>
       </list>
     </property>
    </bean>

    <util:list id="org-options">
        <bean parent="Uif-KeyLabelPair" p:key="102" p:value="Registrar's Office"/>
        <bean parent="Uif-KeyLabelPair" p:key="34" p:value="Medical School"/>
    </util:list>

   <util:list id="hctime-options">
       <bean parent="Uif-KeyLabelPair" p:key="" p:value=""/>
       <bean parent="Uif-KeyLabelPair" p:key="AM" p:value="am"/>
       <bean parent="Uif-KeyLabelPair" p:key="PM" p:value="pm"/>
   </util:list>

</beans>
