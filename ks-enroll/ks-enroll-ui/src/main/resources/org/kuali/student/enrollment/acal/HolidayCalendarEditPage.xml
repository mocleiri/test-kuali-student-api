<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util-2.0.xsd">

    <bean id="KS-HolidayCalendar-EditPage" parent="Uif-Page"
          p:id="holidayCalendarEditPage"
          p:headerText="@{holidayCalendarInfo.name != null? holidayCalendarInfo.name : 'New Holiday Calendar'}"
          p:disclosure.render="false"
          p:header.id="KS-HolidayCalendar-EditPage-header">
        <property name="header">
            <bean parent="Uif-HeaderTwo"/>
        </property>
        <property name="items">
            <list>
                <ref bean="KS-HolidayCalendar-MetaSection"/>
                <ref bean="KS-HolidayCalendar-HolidaySection"/>
            </list>
        </property>
        <property name="footer">
            <bean parent="Uif-FooterBase">
                <property name="items">
                    <list>
                        <bean parent="Uif-PrimaryActionButton"
                              p:methodToCall="@{officialCalendar ? 'save' : 'makeOfficial'}"
                              p:actionLabel="@{officialCalendar ? 'Update Official' : 'Make Official'}"
                              p:disabled="@{newCalendar}" p:performClientSideValidation="@{officialCalendar}" />
                        <bean parent="Uif-SecondaryActionButton" p:methodToCall="save" p:actionLabel="Save"
                              p:performClientSideValidation="true" p:render="@{!officialCalendar}"/>
                        <bean parent="Uif-ActionLink" p:methodToCall="delete"
                              p:actionLabel="@{officialCalendar ? 'Delete Calendar' : 'Delete Draft'}"
                              p:actionScript="confirmDeletion('Are you sure you want to delete this holiday calendar?')"
                              p:render="@{!newCalendar and !officialUI}"/>
                        <bean parent="Uif-ActionLink" p:actionLabel="Cancel" p:actionScript="stepBrowserBack()"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="KS-HolidayCalendar-MetaSection" parent="Uif-VerticalBoxSection" p:layoutManager.orientation="HORIZONTAL">
        <property name="headerText" value="Calendar Information" />
        <property name="disclosure.render" value="false"/>
        <property name="items">
            <list>
                 <bean parent="Uif-InputField" p:label="Holiday Calendar Name"
					p:labelPlacement="TOP" p:fieldLabel.renderColon="false"
					p:propertyName="holidayCalendarInfo.name" p:required="true">
					<property name="control">
						<bean parent="Uif-TextControl" p:size="30" />
					</property>
				</bean>
                <bean parent="Uif-InputField" p:propertyName="holidayCalendarInfo.adminOrgId"
                      p:label="Organization" p:fieldLabel.renderColon="false" p:fieldLabel.style="display:block;">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hcorg-options"/>
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:label="Start Date" p:labelPlacement="TOP" p:required="true"
				     p:fieldLabel.renderColon="false" p:fieldLabel.cssClasses="labelTop"
					p:propertyName="holidayCalendarInfo.startDate">
                    <property name="validCharactersConstraint">
						<bean parent="BasicDatePatternConstraint" />
					</property>
					<property name="control">
						<bean parent="Uif-DateControl" />
					</property>
				</bean>
                <bean parent="Uif-InputField" p:label="End Date" p:labelPlacement="TOP" p:required="true"
					p:fieldLabel.cssClasses="labelTop" p:fieldLabel.renderColon="false"
					p:propertyName="holidayCalendarInfo.endDate">
                    <property name="validCharactersConstraint">
						<bean parent="BasicDatePatternConstraint" />
					</property>
					<property name="control">
						<bean parent="Uif-DateControl" />
					</property>
				</bean>
                <!-- NOTE:
                        This hidden button defeats a KRAD 2.0 bug which causes Enter to fire the next action
                        found - in this case, the "add" button of the addline for the Holidays collection.
                -->
                <bean parent="Uif-SecondaryActionButton-Small" p:style="visibility:hidden;width:2px;" p:actionScript="void(0);"/>
                <!-- END OF KRAD WORK-AROUND -->
            </list>
        </property>
    </bean>

    <bean id="KS-HolidayCalendar-HolidaySection" parent="Uif-TableCollectionSection"
          p:id="KS-HolidayCalendar-HolidaySection"
		  p:layoutManager.numberOfColumns="10"
          p:layoutManager.style="width: 100%; display:block;">
		<property name="headerText" value="Holidays" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.HolidayWrapper" />
		<property name="propertyName" value="holidays" />
		<property name="layoutManager.renderSequenceField" value="false" />
        <property name="layoutManager.separateAddLine" value="false" />
        <property name="layoutManager.richTable.render" value="false" />
        <property name="layoutManager.applyDefaultCellWidths" value="false" />
        <property name="layoutManager.applyAlternatingRowStyles" value="false" />
        <property name="cssClasses">
            <list merge="true">
                <value>ks-holidays-collection</value>
            </list>
        </property>
        <property name="items">
			<list>
                <bean parent="Uif-InputField" p:propertyName="typeKey"  p:readOnlyDisplayReplacementPropertyName="typeName"
                      p:label="Holiday Type" p:required="true" p:readOnly="@{!#isAddLine}"
                      p:finalizeMethodToCall="populateHolidayTypes">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="startDate"
                      p:label="Start Date" p:required="true">
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy" />
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="startTime" p:label="Start Time"
                      p:id="timeFieldStart">
                    <!--<property name="progressiveRender" value="@{#lp.allDay eq false}"/>-->
                    <!-- may work with Rice 2.2...
                    <property name="dependencyConstraints">
                        <list>
                            <bean parent="PrerequisiteConstraint" p:propertyName="startTimeAmPm" />
                        </list>
                    </property>
                        Rice 2.2... -->
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                            <!--<property name="onKeyUpScript" value="setAttributesFromTimeField(jq(this));"/>
                            <property name="onChangeScript" value="setAttributesFromTimeField(jq(this));"/>-->
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="startTimeAmPm" p:id="timeFieldStartAmPm">
                    <!-- expression causes runtime exc on refresh with 'disabled' property
                    <property name="required" value="@{!#lp.allDay and !#empty(#lp.startTime)}"/>
                    <property name="refreshWhenChangedPropertyNames" value="#lp.startTime,#lp.allDay"/>
                        -->
                    <!--<property name="progressiveRender" value="@{#lp.allDay eq false}"/>-->
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay or #empty(#lp.startTime)}"/>
                        </bean>
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="endDate" p:render="@{!#view.readOnly}"
                      p:id="endDate" p:label="End Date">
                    <property name="required" value="@{#lp.dateRange}"/>
                    <property name="refreshWhenChangedPropertyNames" value="#lp.dateRange"/>
                    <property name="control">
                        <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy">
                            <property name="disabled" value="@{!#lp.dateRange}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="endTime" p:id="timeFieldEnd"
                      p:label="End Time">
                    <!--<property name="progressiveRender" value="@{#lp.allDay eq false}"/>-->
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                            <!--<property name="onKeyUpScript" value="setAttributesFromTimeField(jq(this));"/>
                            <property name="onChangeScript" value="setAttributesFromTimeField(jq(this));"/>-->
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-InputField" p:propertyName="endTimeAmPm" p:id="timeFieldEndAmPm">
                    <!-- expression causes runtime exc on refresh with 'disabled' property
                    <property name="required" value="@{!#empty(#lp.endTime)}"/>
                    <property name="refreshWhenChangedPropertyNames" value="#lp.endTime"/>
                        -->
                    <!--<property name="progressiveRender" value="@{#lp.allDay eq false}"/>-->
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay or #empty(#lp.endTime)}"/>
                        </bean>
                    </property>
                </bean>
	            <bean parent="Uif-InputField" p:propertyName="allDay" p:id="allDayCheckbox"
                      p:label="All Day">
                    <property name="onClickScript" value="setAttributesFromAllDayCheckbox(jq(this));"/>
					<property name="control">
						<bean parent="Uif-CheckboxControl"/>
					</property>
				</bean>
                <bean parent="Uif-InputField" p:propertyName="dateRange" p:id="dateRangeCheckbox"
                      p:label="Date Range">
					<property name="control">
						<bean parent="Uif-CheckboxControl"/>
					</property>
				</bean>
				<bean parent="Uif-InputField" p:propertyName="instructional" p:label="Instructional">
					<property name="control">
						<bean parent="Uif-CheckboxControl" />
					</property>
				</bean>
			</list>
		</property>
        <property name="lineActions">
            <list>
                <bean parent="Uif-PrimaryActionButton-Small" p:methodToCall="deleteHoliday" p:actionLabel="delete"/>
            </list>
        </property>
	</bean>

    <util:list id="hcorg-options">
       <bean parent="Uif-KeyLabelPair" p:key="102" p:value="Registrar's Office"/>
    </util:list>

    <util:list id="hctime-options">
        <bean parent="Uif-KeyLabelPair" p:key="" p:value=""/>
        <bean parent="Uif-KeyLabelPair" p:key="AM" p:value="am"/>
        <bean parent="Uif-KeyLabelPair" p:key="PM" p:value="pm"/>
    </util:list>

</beans>

